<template>
  <require from="./components/dyn-table"></require>
  <spinner if.bind="isProcessing"></spinner>
  <div if.bind="content">
    <div class="page-header">
      <div class="title">
        ${content.title ? content.title : 'unknown'}
        <div class="text-small text-secondary" if.bind="content.description">
          ${content.description ? content.description : 'No description given'}
        </div>
      </div>
      <div class="actions">
        <button type="button" class="btn btn-secondary btn-outline mono-font" click.trigger="reload()" if.bind="dashboard.id === 'remote'">
          <i class="fas fa-save"></i> Save
        </button>
        <button type="button" class="btn btn-default btn-outline mono-font" click.trigger="reload()" if.bind="content && dashboard.id != 'remote'">
          <i class="fas fa-sync"></i> Reload
        </button>
      </div>
    </div>
  
    <section class="tile-container" if.bind="content.panels">
      <div class="tile ${panel.options.width_class ? panel.options.width_class : ''}" repeat.for="panel of content.panels">
        <panel>
          <div slot="header">
            <div class="title">${panel.title}</div>
          </div>
          <div slot="body">
            <div if.bind="panel.widget_type == 'markdown'">
              <div innerhtml.bind="panel.data.content"></div>
            </div>
            <div if.bind="panel.widget_type == 'table'">
              <dyn-table rows.bind="panel.data.rows" columns.bind="panel.data.columns"></dyn-table>
            </div>
            <div if.bind="panel.widget_type == 'bar-chart'">
              <data-chart labels.bind="panel.data.labels" values.bind="panel.data.values" options.bind="panel.data.options" chart-type="bar"></data-chart>
            </div>
            <div if.bind="panel.widget_type == 'pie-chart'">
              <data-chart labels.bind="panel.data.labels" values.bind="panel.data.values" options.bind="panel.data.options" chart-type="pie"></data-chart>
            </div>
            <div if.bind="panel.widget_type == 'line-chart'">
              <data-chart labels.bind="panel.data.labels" values.bind="panel.data.values" options.bind="panel.data.options" chart-type="line"></data-chart>
            </div>
          </div>
        </panel>
      </div>
    </div>
  </div>
</template>